<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI智能助手 - 您的专属AI伙伴</title>
    <meta name="description" content="现代化AI聊天助手，支持多角色对话、语音交互、文本处理">
    
    <!-- 样式文件 -->
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/animations.css">
    <link rel="stylesheet" href="styles/hologram-robot.css">
    
    <!-- 预加载关键资源 -->
    <link rel="preload" href="scripts/app.js" as="script">
    
    <!-- 图标和主题色 -->
    <link rel="icon" type="image/svg+xml" href="assets/icons/favicon.svg">
    
    <!-- 主题色配置 - 将通过JavaScript动态设置 -->
    <!-- 初始主题色，避免闪烁 -->
    <meta name="theme-color" content="#007AFF">
    <meta name="msapplication-TileColor" content="#007AFF">
    <meta name="msapplication-navbutton-color" content="#007AFF">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
</head>
<body>
    <!-- 主应用容器 -->
    <div id="app" class="app-container">
        
        <!-- 顶部导航栏 -->
        <header class="app-header">
            <div class="header-left">
                <!-- 汉堡菜单按钮 -->
                <button class="sidebar-toggle-btn" id="sidebarToggleBtn" data-i18n-title="nav.toggle_sidebar" title="切换侧边栏" aria-label="切换侧边栏">
                    <div class="hamburger-icon">
                        <span class="hamburger-line"></span>
                        <span class="hamburger-line"></span>
                        <span class="hamburger-line"></span>
                    </div>
                </button>
                
                <div class="logo-container">
                    <svg class="logo-icon" width="32" height="32" viewBox="0 0 32 32" fill="none">
                        <defs>
                            <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#007AFF" stop-opacity="1" />
                                <stop offset="100%" stop-color="#AF52DE" stop-opacity="1" />
                            </linearGradient>
                        </defs>
                        <circle cx="16" cy="16" r="14" fill="url(#logoGradient)" opacity="0.1"/>
                        <path d="M8 12C8 8.68629 10.6863 6 14 6H18C21.3137 6 24 8.68629 24 12V16C24 19.3137 21.3137 22 18 22H16L12 26V22H14C10.6863 22 8 19.3137 8 16V12Z" fill="url(#logoGradient)"/>
                        <circle cx="13" cy="13" r="1.5" fill="white" opacity="0.9"/>
                        <circle cx="16" cy="13" r="1.5" fill="white" opacity="0.9"/>
                        <circle cx="19" cy="13" r="1.5" fill="white" opacity="0.9"/>
                        <path d="M14 17H18C18.5523 17 19 17.4477 19 18C19 18.5523 18.5523 19 18 19H14C13.4477 19 13 18.5523 13 18C13 17.4477 13.4477 17 14 17Z" fill="white" opacity="0.7"/>
                    </svg>
                    <h1 class="app-title" data-i18n="nav.logo">AI助手</h1>
                </div>
            </div>
            
            <div class="header-center">
                <!-- 角色下拉选择器 -->
                <div class="role-dropdown" id="roleDropdown">
                    <button class="role-dropdown-trigger" id="roleDropdownTrigger" aria-expanded="false" aria-haspopup="true">
                        <div class="role-current">
                            <svg class="role-current-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M10 2C6.68629 2 4 4.68629 4 8V10C4 13.3137 6.68629 16 10 16C13.3137 16 16 13.3137 16 10V8C16 4.68629 13.3137 2 10 2Z"/>
                                <circle cx="7" cy="8" r="1"/>
                                <circle cx="13" cy="8" r="1"/>
                                <path d="M7 11H13C13 12.1046 12.1046 13 11 13H9C7.89543 13 7 12.1046 7 11Z"/>
                            </svg>
                            <span class="role-current-name" data-i18n="role.assistant">智能助手</span>
                        </div>
                        <svg class="dropdown-arrow" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                        </svg>
                    </button>
                    
                    <div class="role-dropdown-menu" id="roleDropdownMenu">
                        <div class="role-dropdown-content">
                            <button class="role-option active" data-role="assistant">
                                <div class="role-option-icon">
                                    <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                        <path d="M10 2C6.68629 2 4 4.68629 4 8V10C4 13.3137 6.68629 16 10 16C13.3137 16 16 13.3137 16 10V8C16 4.68629 13.3137 2 10 2Z"/>
                                        <circle cx="7" cy="8" r="1"/>
                                        <circle cx="13" cy="8" r="1"/>
                                        <path d="M7 11H13C13 12.1046 12.1046 13 11 13H9C7.89543 13 7 12.1046 7 11Z"/>
                                    </svg>
                                </div>
                                <div class="role-option-info">
                                    <span class="role-option-name" data-i18n="role.assistant">智能助手</span>
                                    <span class="role-option-desc" data-i18n="role.assistant.desc">友善专业的AI助手</span>
                                </div>
                                <div class="role-option-check">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M13 4L6 11L3 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                                    </svg>
                                </div>
                            </button>
                            
                            <button class="role-option" data-role="teacher">
                                <div class="role-option-icon">
                                    <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                        <path d="M10 2L3 6L10 10L17 6L10 2Z"/>
                                        <path d="M3 8V14C3 15.1046 6.13401 16 10 16C13.866 16 17 15.1046 17 14V8L10 12L3 8Z"/>
                                        <circle cx="15" cy="10" r="1"/>
                                    </svg>
                                </div>
                                <div class="role-option-info">
                                    <span class="role-option-name" data-i18n="role.teacher">教师</span>
                                    <span class="role-option-desc" data-i18n="role.teacher.desc">专业的教育指导老师</span>
                                </div>
                                <div class="role-option-check">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M13 4L6 11L3 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                                    </svg>
                                </div>
                            </button>
                            
                            <button class="role-option" data-role="doctor">
                                <div class="role-option-icon">
                                    <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                        <path d="M10 2C8.89543 2 8 2.89543 8 4V6H6C4.89543 6 4 6.89543 4 8V16C4 17.1046 4.89543 18 6 18H14C15.1046 18 16 17.1046 16 16V8C16 6.89543 15.1046 6 14 6H12V4C12 2.89543 11.1046 2 10 2Z"/>
                                        <path d="M9 10H11V12H13V14H11V16H9V14H7V12H9V10Z" fill="white"/>
                                    </svg>
                                </div>
                                <div class="role-option-info">
                                    <span class="role-option-name" data-i18n="role.doctor">医生</span>
                                    <span class="role-option-desc" data-i18n="role.doctor.desc">专业的医疗健康顾问</span>
                                </div>
                                <div class="role-option-check">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M13 4L6 11L3 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                                    </svg>
                                </div>
                            </button>
                            
                            <button class="role-option" data-role="leader">
                                <div class="role-option-icon">
                                    <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                        <path d="M10 2L12.5 7H18L14 10.5L15.5 16L10 13L4.5 16L6 10.5L2 7H7.5L10 2Z"/>
                                    </svg>
                                </div>
                                <div class="role-option-info">
                                    <span class="role-option-name" data-i18n="role.leader">领导</span>
                                    <span class="role-option-desc" data-i18n="role.leader.desc">经验丰富的管理决策者</span>
                                </div>
                                <div class="role-option-check">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M13 4L6 11L3 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                                    </svg>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="header-right">
                <!-- 设置按钮 -->
                <button class="header-btn" id="settingsBtn" data-i18n-title="nav.settings" title="设置">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M10 12C11.1046 12 12 11.1046 12 10C12 8.89543 11.1046 8 10 8C8.89543 8 8 8.89543 8 10C8 11.1046 8.89543 12 10 12Z"/>
                        <path d="M8.5 2H11.5L12 4.5C12.5 4.7 13 5 13.4 5.4L16 4.5L17.5 7L15.4 8.9C15.5 9.3 15.5 9.7 15.4 10.1L17.5 12L16 14.5L13.4 13.6C13 14 12.5 14.3 12 14.5L11.5 17H8.5L8 14.5C7.5 14.3 7 14 6.6 13.6L4 14.5L2.5 12L4.6 10.1C4.5 9.7 4.5 9.3 4.6 8.9L2.5 7L4 4.5L6.6 5.4C7 5 7.5 4.7 8 4.5L8.5 2Z"/>
                    </svg>
                </button>
            </div>
        </header>

        <!-- 主内容区域 -->
        <main class="app-main">
            
            <!-- 侧边栏 -->
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <h3 data-i18n="sidebar.history">对话历史</h3>
                    <button class="new-chat-btn" id="newChatBtn">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8 1C8.55228 1 9 1.44772 9 2V7H14C14.5523 7 15 7.44772 15 8C15 8.55228 14.5523 9 14 9H9V14C9 14.5523 8.55228 15 8 15C7.44772 15 7 14.5523 7 14V9H2C1.44772 9 1 8.55228 1 8C1 7.44772 1.44772 7 2 7H7V2C7 1.44772 7.44772 1 8 1Z"/>
                        </svg>
                        <span data-i18n="sidebar.new_chat">新对话</span>
                    </button>
                </div>
                
                <div class="chat-history" id="chatHistory">
                    <!-- 对话历史列表将通过JS动态生成 -->
                </div>
                
            </aside>

            <!-- 聊天区域 -->
            <section class="chat-section">
                
                <!-- 欢迎页面 -->
                <div class="welcome-screen" id="welcomeScreen">
                    <div class="welcome-content">
                        <div class="welcome-avatar">
                    <svg width="80" height="80" viewBox="0 0 80 80" class="avatar-icon" fill="none">
                        <defs>
                            <linearGradient id="avatarGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#007AFF" stop-opacity="1" />
                                <stop offset="100%" stop-color="#AF52DE" stop-opacity="1" />
                            </linearGradient>
                        </defs>
                        <circle cx="40" cy="40" r="35" fill="url(#avatarGradient)" opacity="0.1"/>
                        <circle cx="40" cy="40" r="30" fill="url(#avatarGradient)"/>
                        <circle cx="32" cy="35" r="3" fill="white" opacity="0.9"/>
                        <circle cx="48" cy="35" r="3" fill="white" opacity="0.9"/>
                        <path d="M30 50C30 46 34 42 40 42C46 42 50 46 50 50" stroke="white" stroke-width="3" stroke-linecap="round" fill="none" opacity="0.8"/>
                    </svg>
                        </div>
                        <h2 class="welcome-title" data-i18n="welcome.title">您好！我是您的专属智能机器人</h2>
                        <p class="welcome-subtitle" data-i18n="welcome.subtitle">点击我切换角色</p>
                        
                        <div class="welcome-features">
                            <!-- 智能AI助手机器人 -->
                            <div id="mainRobot" class="feature-robot-container single-robot"></div>
                        </div>
                    </div>
                </div>

                <!-- 聊天消息区域 -->
                <div class="chat-messages" id="chatMessages">
                    <!-- 聊天消息将通过JS动态生成 -->
                </div>

                <!-- 输入区域 -->
                <div class="chat-input-area">
                    <div class="input-container">
                        <!-- 功能按钮组 -->
                        <div class="input-actions-left">
                            <button class="input-action-btn" id="voiceBtn" data-i18n-title="input.voice" title="语音输入">
                                <svg width="20" height="20" viewBox="0 0 20 20" class="voice-icon" fill="currentColor">
                                    <path d="M10 2C8.34315 2 7 3.34315 7 5V10C7 11.6569 8.34315 13 10 13C11.6569 13 13 11.6569 13 10V5C13 3.34315 11.6569 2 10 2Z"/>
                                    <path d="M5 8V10C5 12.7614 7.23858 15 10 15C12.7614 15 15 12.7614 15 10V8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" fill="none"/>
                                    <path d="M10 15V18M10 18H7M10 18H13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" fill="none"/>
                                </svg>
                            </button>
                            <button class="input-action-btn" id="attachBtn" data-i18n-title="input.attach" title="上传文件">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M11.5 2C10.1193 2 9 3.11929 9 4.5V12.5C9 14.9853 11.0147 17 13.5 17C15.9853 17 18 14.9853 18 12.5V6C18 5.44772 17.5523 5 17 5C16.4477 5 16 5.44772 16 6V12.5C16 13.8807 14.8807 15 13.5 15C12.1193 15 11 13.8807 11 12.5V4.5C11 4.22386 11.2239 4 11.5 4C11.7761 4 12 4.22386 12 4.5V11C12 11.5523 12.4477 12 13 12C13.5523 12 14 11.5523 14 11V4.5C14 3.11929 12.8807 2 11.5 2Z"/>
                                </svg>
                            </button>
                        </div>

                        <!-- 输入框 -->
                        <div class="input-wrapper">
                            <textarea 
                                id="messageInput" 
                                class="message-input" 
                                data-i18n="input.placeholder" placeholder="输入您的问题，或点击语音按钮开始语音对话..."
                                rows="1"
                                maxlength="2000"></textarea>
                            <div class="input-counter">
                                <span id="charCounter">0/2000</span>
                            </div>
                        </div>

                        <!-- 功能菜单按钮 -->
                        <div class="input-functions" id="inputFunctions">
                            <button class="function-menu-btn" id="functionMenuBtn" data-i18n-title="input.functions" title="文本处理功能" aria-label="文本处理功能">
                                <svg width="20" height="20" viewBox="0 0 20 20" class="function-icon" fill="currentColor">
                                    <path d="M10 2L12.5 7H18L14 10.5L15.5 16L10 13L4.5 16L6 10.5L2 7H7.5L10 2Z"/>
                                </svg>
                            </button>
                            
                            <!-- 功能下拉菜单 -->
                            <div class="function-dropdown-menu" id="functionDropdownMenu">
                                <div class="function-dropdown-content">
                                    <button class="function-option" data-action="translate">
                                        <div class="function-option-icon">
                                            <svg width="18" height="18" viewBox="0 0 18 18" fill="currentColor">
                                                <path d="M2 2C1.44772 2 1 2.44772 1 3V13C1 13.5523 1.44772 14 2 14H6L8 16L10 14H14C14.5523 14 15 13.5523 15 13V3C15 2.44772 14.5523 2 14 2H2Z"/>
                                                <path d="M4 5H12M4 8H10M4 11H8" stroke="white" stroke-width="1" stroke-linecap="round"/>
                                            </svg>
                                        </div>
                                        <div class="function-option-info">
                                            <span class="function-option-name" data-i18n="function.translate">翻译文本</span>
                                            <span class="function-option-desc" data-i18n="function.translate.desc">将文本翻译成其他语言</span>
                                        </div>
                                    </button>
                                    
                                    <button class="function-option" data-action="polish">
                                        <div class="function-option-icon">
                                            <svg width="18" height="18" viewBox="0 0 18 18" fill="currentColor">
                                                <path d="M9 1L11 5L16 6L12.5 9.5L13.5 15L9 12.5L4.5 15L5.5 9.5L2 6L7 5L9 1Z"/>
                                            </svg>
                                        </div>
                                        <div class="function-option-info">
                                            <span class="function-option-name" data-i18n="function.polish">润色文本</span>
                                            <span class="function-option-desc" data-i18n="function.polish.desc">优化文本表达和语言风格</span>
                                        </div>
                                    </button>
                                    
                                    <button class="function-option" data-action="summarize">
                                        <div class="function-option-icon">
                                            <svg width="18" height="18" viewBox="0 0 18 18" fill="currentColor">
                                                <path d="M3 4C3 3.44772 3.44772 3 4 3H14C14.5523 3 15 3.44772 15 4C15 4.55228 14.5523 5 14 5H4C3.44772 5 3 4.55228 3 4Z"/>
                                                <path d="M3 8C3 7.44772 3.44772 7 4 7H14C14.5523 7 15 7.44772 15 8C15 8.55228 14.5523 9 14 9H4C3.44772 9 3 8.55228 3 8Z"/>
                                                <path d="M3 12C3 11.4477 3.44772 11 4 11H10C10.5523 11 11 11.4477 11 12C11 12.5523 10.5523 13 10 13H4C3.44772 13 3 12.5523 3 12Z"/>
                                            </svg>
                                        </div>
                                        <div class="function-option-info">
                                            <span class="function-option-name" data-i18n="function.summarize">总结文本</span>
                                            <span class="function-option-desc" data-i18n="function.summarize.desc">提取文本要点和关键信息</span>
                                        </div>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- 发送按钮 -->
                        <button class="send-btn" id="sendBtn" disabled data-i18n-title="input.send" title="发送消息" aria-label="发送消息">
                            <svg width="20" height="20" viewBox="0 0 20 20" class="send-icon" fill="currentColor">
                                <path d="M2 10L18 2L12 10L18 18L2 10Z"/>
                                <path d="M12 10H8" stroke="white" stroke-width="1.5" stroke-linecap="round" fill="none"/>
                            </svg>
                        </button>
                    </div>

                    <!-- 快捷操作提示 -->
                    <div class="input-tips" id="inputTips">
                        <div class="tip-item">
                            <kbd>Enter</kbd> <span data-i18n="input.tip.enter">发送消息</span>
                        </div>
                        <div class="tip-item">
                            <kbd>Shift + Enter</kbd> <span data-i18n="input.tip.shift_enter">换行</span>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- 设置面板 -->
    <div class="settings-panel" id="settingsPanel">
        <div class="settings-content">
            <div class="settings-header">
                <h3 data-i18n="settings.title">设置</h3>
                <button class="close-btn" id="closeSettingsBtn" data-i18n-title="settings.close" title="关闭设置" aria-label="关闭设置">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M15 5L5 15M5 5L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none"/>
                    </svg>
                </button>
            </div>
            
            <div class="settings-body">
                <!-- API配置 -->
                <div class="settings-section">
                    <h4 data-i18n="settings.api">AI模型配置</h4>
                    <div class="setting-item">
                        <label for="apiProvider" data-i18n="settings.api.provider">AI提供商</label>
                        <select id="apiProvider" class="setting-select">
                            <option value="free">🎁 免费体验（推荐新用户）</option>
                            <option value="openai">OpenAI GPT</option>
                            <option value="deepseek">DeepSeek</option>
                            <option value="claude">Claude</option>
                            <option value="custom">自定义</option>
                        </select>
                    </div>
                    
                    <!-- 免费服务使用统计 -->
                    <div id="freeUsageDisplay" class="free-usage-display hidden">
                        <!-- 动态内容将由JavaScript生成 -->
                    </div>
                    <div class="setting-item">
                        <label for="apiKey" data-i18n="settings.api.key">API密钥</label>
                        <input type="password" id="apiKey" class="setting-input" data-i18n="settings.api.key.placeholder" placeholder="请输入您的API密钥">
                    </div>
                </div>

                <!-- 语言设置 -->
                <div class="settings-section">
                    <h4 data-i18n="settings.language">语言设置</h4>
                    <div class="setting-item">
                        <label for="language" data-i18n="settings.language.interface">界面语言</label>
                        <select id="language" class="setting-select">
                            <option value="zh-CN">中文简体</option>
                            <option value="zh-TW">中文繁体</option>
                            <option value="en">English</option>
                            <option value="ja">日本語</option>
                        </select>
                    </div>
                </div>

                <!-- 主题设置 -->
                <div class="settings-section">
                    <h4 data-i18n="settings.theme">外观设置</h4>
                    <div class="setting-item">
                        <label for="theme" data-i18n="settings.theme.mode">主题模式</label>
                        <select id="theme" class="setting-select">
                            <option value="auto" data-i18n="settings.theme.auto">跟随系统</option>
                            <option value="light" data-i18n="settings.theme.light">浅色模式</option>
                            <option value="dark" data-i18n="settings.theme.dark">深色模式</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 加载指示器 -->
    <div class="loading-indicator" id="loadingIndicator">
        <div class="loading-spinner"></div>
        <span class="loading-text">AI正在思考中...</span>
    </div>

    <!-- 通知提示 -->
    <div class="notification" id="notification">
        <div class="notification-content">
            <span class="notification-message"></span>
                    <button class="notification-close" title="关闭通知" aria-label="关闭通知">×</button>
        </div>
    </div>

    <!-- JavaScript文件 -->
    <script src="scripts/utils.js"></script>
    <script src="scripts/i18n.js"></script>
    <script src="scripts/api.js"></script>
    <script src="scripts/voice.js"></script>
    <script src="scripts/hologram-robot.js"></script>
    <script src="scripts/role-sync.js"></script>
    <script src="scripts/chat.js"></script>
    <script src="scripts/app.js"></script>
</body>
</html>
